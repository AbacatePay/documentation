---
title: Servidor MCP
description: "Integre a AbacatePay com assistentes de IA como Claude e Cursor atrav√©s do Model Context Protocol"
icon: 'robot'
---

O servidor MCP (Model Context Protocol) da AbacatePay permite que voc√™ gerencie pagamentos, clientes e cobran√ßas diretamente atrav√©s de assistentes de IA como Claude Desktop, Cursor e outras ferramentas compat√≠veis com MCP.

## <Icon icon="Avocado" type="solid"/> O que √© o Servidor MCP?

O Model Context Protocol √© um protocolo desenvolvido pela Anthropic que permite que assistentes de IA acessem ferramentas e recursos externos de forma segura e padronizada. Nosso servidor MCP exp√µe todas as funcionalidades da API AbacatePay como ferramentas que podem ser usadas por assistentes de IA.

**Principais benef√≠cios:**

- ü§ñ **Integra√ß√£o com IA**: Use comandos naturais para gerenciar pagamentos
- üîê **Seguro**: Suporte a m√∫ltiplas API keys e isolamento de dados
- üöÄ **F√°cil de usar**: Configure uma vez e use em qualquer cliente MCP
- üåê **Flex√≠vel**: Funciona em modo stdio (Cursor/Claude) e HTTP (automa√ß√µes)

## <Icon icon="download" type="solid"/> Instala√ß√£o

### Pr√©-requisitos

- [Bun](https://bun.sh) instalado (vers√£o 1.0.0 ou superior)

### Instala√ß√£o

```bash
git clone https://github.com/AbacatePay/abacatepay-mcp.git
cd abacatepay-mcp
bun install
```

## <Icon icon="cog" type="solid"/> Configura√ß√£o

O servidor MCP funciona de duas formas diferentes dependendo de como voc√™ vai us√°-lo:

### üì± Modo stdio (Cursor, Claude Desktop)

No modo stdio, o servidor se comunica via entrada/sa√≠da padr√£o. A API key deve ser configurada via vari√°vel de ambiente.

#### Configura√ß√£o no Cursor

1. Abra as configura√ß√µes do Cursor:
   - Pressione `Ctrl+Shift+P` (ou `Cmd+Shift+P` no Mac)
   - Digite "Preferences: Open User Settings (JSON)"
   - Ou v√° em: `File` ‚Üí `Preferences` ‚Üí `Settings` ‚Üí Clique no √≠cone `{}` no canto superior direito

2. Adicione a configura√ß√£o:

```json
{
  "mcp.servers": {
    "abacate-pay": {
      "command": "bun",
      "args": ["/caminho/completo/para/abacatepay-mcp/src/index.ts"],
      "env": {
        "ABACATE_PAY_API_KEY": "sua_api_key_aqui"
      }
    }
  }
}
```

3. Reinicie o Cursor para aplicar as mudan√ßas.

#### Configura√ß√£o no Claude Desktop

1. Abra o arquivo de configura√ß√£o do Claude Desktop:
   - **macOS**: `~/Library/Application Support/Claude/claude_desktop_config.json`
   - **Windows**: `%APPDATA%\Claude\claude_desktop_config.json`

2. Adicione a configura√ß√£o:

```json
{
  "mcpServers": {
    "abacate-pay": {
      "command": "bun",
      "args": ["/caminho/completo/para/abacatepay-mcp/src/index.ts"],
      "env": {
        "ABACATE_PAY_API_KEY": "sua_api_key_aqui"
      }
    }
  }
}
```

3. Reinicie o Claude Desktop.

<Card title="Importante" icon="info-circle" color="#25c2a0">
  No modo stdio, a API key deve ser configurada via vari√°vel de ambiente `env` na configura√ß√£o do cliente, pois n√£o h√° headers HTTP dispon√≠veis.
</Card>

### üåê Modo HTTP (AgentKit, n8n, automa√ß√µes)

No modo HTTP, o servidor aceita requisi√ß√µes HTTP e pode ser usado com ferramentas de automa√ß√£o.

#### Iniciando o servidor HTTP

```bash
# Iniciar servidor HTTP
bun run start:http

# Ou com porta customizada
MCP_PORT=8080 bun run start:http
```

#### Autentica√ß√£o no modo HTTP

A API key pode ser fornecida de duas formas:

**1. Via Header HTTP (Recomendado):**

```bash
curl -X POST http://localhost:3000/mcp \
  -H "Authorization: Bearer sua_api_key_aqui" \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "id": 1,
    "method": "tools/call",
    "params": {
      "name": "createCustomer",
      "arguments": {
        "name": "Jo√£o Silva",
        "cellphone": "(11) 99999-9999",
        "email": "joao@exemplo.com",
        "taxId": "123.456.789-01"
      }
    }
  }'
```

**2. Via Header X-API-Key:**

```bash
curl -X POST http://localhost:3000/mcp \
  -H "X-API-Key: sua_api_key_aqui" \
  -H "Content-Type: application/json" \
  -d '{...}'
```

<Card title="Dica" icon="lightbulb" horizontal>
  No modo HTTP, se voc√™ passar a API key no header `Authorization` ou `X-API-Key`, n√£o precisa passar como par√¢metro da ferramenta. O servidor automaticamente usa a chave do header.
</Card>

## <Icon icon="tools" type="solid"/> Ferramentas Dispon√≠veis

O servidor MCP exp√µe as seguintes ferramentas:

### üë• Clientes

#### `createCustomer`

Cria um novo cliente no Abacate Pay.

**Par√¢metros:**

- `name` (string, obrigat√≥rio): Nome completo do cliente
- `cellphone` (string, obrigat√≥rio): Celular do cliente (ex: (11) 4002-8922 ou 79991251557)
- `email` (string, obrigat√≥rio): E-mail do cliente
- `taxId` (string, obrigat√≥rio): CPF ou CNPJ v√°lido do cliente (ex: 123.456.789-01)
- `apiKey` (string, opcional): Chave de API (opcional se configurada globalmente)

**Exemplo de uso no Cursor:**

```
Crie um cliente chamado Jo√£o Silva, com email joao@exemplo.com, 
celular (11) 99999-9999 e CPF 123.456.789-01
```

#### `listCustomers`

Lista todos os clientes cadastrados no Abacate Pay.

**Par√¢metros:**

- `apiKey` (string, opcional): Chave de API (opcional se configurada globalmente)

**Exemplo de uso no Cursor:**

```
Liste todos os meus clientes cadastrados
```

### üí∞ Cobran√ßas

#### `createBilling`

Cria uma nova cobran√ßa no Abacate Pay.

**Par√¢metros:**

- `frequency` (enum, opcional): Tipo de frequ√™ncia - `ONE_TIME` ou `MULTIPLE_PAYMENTS` (padr√£o: `ONE_TIME`)
- `methods` (array, opcional): M√©todos de pagamento - atualmente apenas `["PIX"]` (padr√£o: `["PIX"]`)
- `products` (array, obrigat√≥rio): Lista de produtos
  - `externalId` (string): ID externo do produto
  - `name` (string): Nome do produto
  - `description` (string): Descri√ß√£o do produto
  - `quantity` (number): Quantidade do produto
  - `price` (number): Pre√ßo unit√°rio em centavos
- `returnUrl` (string, obrigat√≥rio): URL para redirecionar caso o cliente clique em 'Voltar'
- `completionUrl` (string, obrigat√≥rio): URL para redirecionar quando o pagamento for conclu√≠do
- `customerId` (string, opcional): ID de um cliente j√° cadastrado
- `apiKey` (string, opcional): Chave de API (opcional se configurada globalmente)

**Exemplo de uso no Cursor:**

```
Crie uma cobran√ßa de R$ 100,00 para o produto "Assinatura Mensal" 
com URL de retorno https://meusite.com/retorno e 
URL de conclus√£o https://meusite.com/sucesso
```

#### `getBilling`

Busca os detalhes de uma cobran√ßa espec√≠fica.

**Par√¢metros:**

- `id` (string, obrigat√≥rio): ID da cobran√ßa
- `apiKey` (string, opcional): Chave de API (opcional se configurada globalmente)

### üì± PIX

#### `createPixQrCode`

Cria um QR Code PIX para pagamento direto.

**Par√¢metros:**

- `amount` (number, obrigat√≥rio): Valor da cobran√ßa em centavos
- `expiresIn` (number, opcional): Tempo de expira√ß√£o em segundos
- `description` (string, opcional): Mensagem que aparecer√° no pagamento PIX (m√°x 140 caracteres)
- `customer` (object, opcional): Dados do cliente
  - `name` (string): Nome completo do cliente
  - `cellphone` (string): Celular do cliente
  - `email` (string): E-mail do cliente
  - `taxId` (string): CPF ou CNPJ do cliente
- `apiKey` (string, opcional): Chave de API (opcional se configurada globalmente)

**Exemplo de uso no Cursor:**

```
Crie um QR Code PIX de R$ 50,00 com a descri√ß√£o "Pagamento de servi√ßo"
```

#### `simulatePixPayment`

Simula o pagamento de um QR Code PIX (apenas em modo desenvolvimento).

**Par√¢metros:**

- `id` (string, obrigat√≥rio): ID do QR Code PIX para simular o pagamento
- `metadata` (object, opcional): Metadados opcionais para a requisi√ß√£o
- `apiKey` (string, opcional): Chave de API (opcional se configurada globalmente)

#### `getPixQrCode`

Verifica o status de um QR Code PIX.

**Par√¢metros:**

- `id` (string, obrigat√≥rio): ID do QR Code PIX para verificar o status
- `apiKey` (string, opcional): Chave de API (opcional se configurada globalmente)

### üé´ Cupons

#### `createCoupon`

Cria um novo cupom de desconto.

**Par√¢metros:**

- `code` (string, obrigat√≥rio): C√≥digo √∫nico do cupom (ex: DESCONTO20)
- `discountKind` (enum, obrigat√≥rio): Tipo de desconto - `PERCENTAGE` (porcentagem) ou `FIXED` (valor fixo)
- `discountValue` (number, obrigat√≥rio): Valor do desconto (em porcentagem ou centavos, dependendo do tipo)
- `maxUses` (number, opcional): N√∫mero m√°ximo de usos do cupom
- `expiresAt` (string, opcional): Data de expira√ß√£o do cupom (formato ISO 8601)
- `apiKey` (string, opcional): Chave de API (opcional se configurada globalmente)

**Exemplo de uso no Cursor:**

```
Crie um cupom de desconto de 15% com c√≥digo ALEX15 que vale para at√© 100 usos
```

#### `getCoupon`

Busca os detalhes de um cupom espec√≠fico.

**Par√¢metros:**

- `code` (string, obrigat√≥rio): C√≥digo do cupom
- `apiKey` (string, opcional): Chave de API (opcional se configurada globalmente)

### üîÑ Saques

#### `createWithdraw`

Cria um novo saque para transferir valores da conta para uma chave PIX.

**Par√¢metros:**

- `description` (string, obrigat√≥rio): Descri√ß√£o do saque
- `externalId` (string, obrigat√≥rio): ID externo para identifica√ß√£o do saque
- `method` (string, obrigat√≥rio): M√©todo de pagamento (ex: PIX)
- `amount` (number, obrigat√≥rio): Valor do saque em centavos
- `pix` (object, obrigat√≥rio): Dados da chave PIX para o saque
  - `type` (string): Tipo da chave PIX (ex: CPF, CNPJ, EMAIL, PHONE, RANDOM)
  - `key` (string): Chave PIX (CPF, CNPJ, email, telefone ou chave aleat√≥ria)
- `apiKey` (string, opcional): Chave de API (opcional se configurada globalmente)

## <Icon icon="code" type="solid"/> Exemplos de Uso

### Exemplo 1: Campanha com Influencer

```
Eu contratei um influencer chamado Alex para divulgar meu neg√≥cio. 
Voc√™ pode criar um cupom com 15% de desconto usando o c√≥digo ALEX15 
que vale para at√© 100 usos? Preciso acompanhar o desempenho da campanha.
```

### Exemplo 2: Investiga√ß√£o de Cobran√ßas

```
Tive uma cobran√ßa estranha ontem que n√£o reconhe√ßo. Voc√™ pode buscar 
todas as cobran√ßas de ontem e me mostrar os detalhes para eu verificar 
o que pode ter acontecido?
```

### Exemplo 3: Novo Cliente Corporativo

```
Acabei de fechar um contrato com a empresa TechSolutions LTDA 
(CNPJ: 12.345.678/0001-90). Pode criar o cadastro deles com o email 
contato@techsolutions.com e telefone (11) 3456-7890? Depois preciso 
gerar um QR Code PIX de R$ 10.000 para o pagamento.
```

### Exemplo 4: Integra√ß√£o HTTP com n8n

```javascript
// Exemplo de requisi√ß√£o HTTP para criar um cliente
const response = await fetch('http://localhost:3000/mcp', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer sua_api_key_aqui',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    jsonrpc: '2.0',
    id: 1,
    method: 'tools/call',
    params: {
      name: 'createCustomer',
      arguments: {
        name: 'Jo√£o Silva',
        cellphone: '(11) 99999-9999',
        email: 'joao@exemplo.com',
        taxId: '123.456.789-01'
      }
    }
  })
});

const result = await response.json();
console.log(result);
```

## <Icon icon="exclamation-triangle" type="solid"/> Problemas Comuns

### Erro de API Key

```
‚ùå Erro: API key √© obrigat√≥ria
```

**Solu√ß√£o:**

- **Modo stdio (Cursor/Claude)**: Verifique se a API key est√° configurada corretamente na vari√°vel de ambiente `env` do arquivo de configura√ß√£o
- **Modo HTTP**: Verifique se a API key est√° sendo enviada no header `Authorization` ou `X-API-Key`

### Servidor MCP n√£o conecta

**Solu√ß√£o:**

1. Verifique se o caminho para o arquivo est√° correto no arquivo de configura√ß√£o
2. Reinicie o cliente (Cursor/Claude Desktop) ap√≥s adicionar a configura√ß√£o
3. Certifique-se de que o Bun est√° instalado e funcionando:

```bash
# Verificar instala√ß√£o do Bun
bun --version

# Se necess√°rio, instalar o Bun
curl -fsSL https://bun.sh/install | bash
```

### Erro de permiss√£o

**Solu√ß√£o:**

Certifique-se de que o Bun est√° instalado corretamente e que o caminho do arquivo est√° acess√≠vel.

## <Icon icon="cloud" type="solid"/> Recursos Adicionais

- **Reposit√≥rio GitHub**: [github.com/AbacatePay/abacatepay-mcp](https://github.com/AbacatePay/abacatepay-mcp)
- **Documenta√ß√£o da API**: Consulte a se√ß√£o de API nesta documenta√ß√£o
- **Suporte**: Entre em contato pelo email <Icon icon="envelope" type="solid"/> ajuda@abacatepay.com

<Card title="Precisa de ajuda?" icon="headset" color="#25c2a0">
  Nossa equipe est√° dispon√≠vel para auxiliar na integra√ß√£o do servidor MCP. Entre em contato pelo e-mail <Icon icon="envelope" type="solid"/> ajuda@abacatepay.com
</Card>

